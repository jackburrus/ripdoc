use std::collections::HashMap;

/// Load standard glyph widths for the 14 standard PDF fonts.
/// Widths are in 1/1000 of a text space unit.
pub fn load_standard_widths(base_font: &str, widths: &mut HashMap<u32, f64>) {
    // Strip font variant suffixes
    let font = base_font
        .replace("-Bold", "")
        .replace("-Italic", "")
        .replace("-BoldItalic", "")
        .replace("-Oblique", "")
        .replace("-BoldOblique", "")
        .replace("-Roman", "");

    match font.as_str() {
        "Courier" | "CourierNew" | "Courier-New" => {
            // All characters in Courier are 600 units wide
            for code in 0..=255u32 {
                widths.insert(code, 600.0);
            }
        }
        "Helvetica" | "Arial" | "ArialMT" => {
            load_helvetica_widths(widths);
        }
        "Times" | "TimesNewRoman" | "Times-NewRoman" | "TimesNewRomanPSMT" => {
            load_times_widths(widths);
        }
        "Symbol" => {
            // Symbol font - use default 500 width
            for code in 0..=255u32 {
                widths.insert(code, 500.0);
            }
        }
        "ZapfDingbats" => {
            for code in 0..=255u32 {
                widths.insert(code, 500.0);
            }
        }
        _ => {
            // For unknown fonts, assume roughly Helvetica-like proportional widths
            load_helvetica_widths(widths);
        }
    }
}

fn load_helvetica_widths(widths: &mut HashMap<u32, f64>) {
    // Approximate Helvetica widths for ASCII range
    let data: &[(u32, f64)] = &[
        (32, 278.0),  // space
        (33, 278.0),  // !
        (34, 355.0),  // "
        (35, 556.0),  // #
        (36, 556.0),  // $
        (37, 889.0),  // %
        (38, 667.0),  // &
        (39, 191.0),  // '
        (40, 333.0),  // (
        (41, 333.0),  // )
        (42, 389.0),  // *
        (43, 584.0),  // +
        (44, 278.0),  // ,
        (45, 333.0),  // -
        (46, 278.0),  // .
        (47, 278.0),  // /
        (48, 556.0),  // 0
        (49, 556.0),  // 1
        (50, 556.0),  // 2
        (51, 556.0),  // 3
        (52, 556.0),  // 4
        (53, 556.0),  // 5
        (54, 556.0),  // 6
        (55, 556.0),  // 7
        (56, 556.0),  // 8
        (57, 556.0),  // 9
        (58, 278.0),  // :
        (59, 278.0),  // ;
        (60, 584.0),  // <
        (61, 584.0),  // =
        (62, 584.0),  // >
        (63, 556.0),  // ?
        (64, 1015.0), // @
        (65, 667.0),  // A
        (66, 667.0),  // B
        (67, 722.0),  // C
        (68, 722.0),  // D
        (69, 667.0),  // E
        (70, 611.0),  // F
        (71, 778.0),  // G
        (72, 722.0),  // H
        (73, 278.0),  // I
        (74, 500.0),  // J
        (75, 667.0),  // K
        (76, 556.0),  // L
        (77, 833.0),  // M
        (78, 722.0),  // N
        (79, 778.0),  // O
        (80, 667.0),  // P
        (81, 778.0),  // Q
        (82, 722.0),  // R
        (83, 667.0),  // S
        (84, 611.0),  // T
        (85, 722.0),  // U
        (86, 667.0),  // V
        (87, 944.0),  // W
        (88, 667.0),  // X
        (89, 667.0),  // Y
        (90, 611.0),  // Z
        (91, 278.0),  // [
        (92, 278.0),  // backslash
        (93, 278.0),  // ]
        (94, 469.0),  // ^
        (95, 556.0),  // _
        (96, 333.0),  // `
        (97, 556.0),  // a
        (98, 556.0),  // b
        (99, 500.0),  // c
        (100, 556.0), // d
        (101, 556.0), // e
        (102, 278.0), // f
        (103, 556.0), // g
        (104, 556.0), // h
        (105, 222.0), // i
        (106, 222.0), // j
        (107, 500.0), // k
        (108, 222.0), // l
        (109, 833.0), // m
        (110, 556.0), // n
        (111, 556.0), // o
        (112, 556.0), // p
        (113, 556.0), // q
        (114, 333.0), // r
        (115, 500.0), // s
        (116, 278.0), // t
        (117, 556.0), // u
        (118, 500.0), // v
        (119, 722.0), // w
        (120, 500.0), // x
        (121, 500.0), // y
        (122, 500.0), // z
        (123, 334.0), // {
        (124, 260.0), // |
        (125, 334.0), // }
        (126, 584.0), // ~
    ];

    for &(code, width) in data {
        widths.insert(code, width);
    }
}

fn load_times_widths(widths: &mut HashMap<u32, f64>) {
    let data: &[(u32, f64)] = &[
        (32, 250.0),  // space
        (33, 333.0),  // !
        (34, 408.0),  // "
        (35, 500.0),  // #
        (36, 500.0),  // $
        (37, 833.0),  // %
        (38, 778.0),  // &
        (39, 180.0),  // '
        (40, 333.0),  // (
        (41, 333.0),  // )
        (42, 500.0),  // *
        (43, 564.0),  // +
        (44, 250.0),  // ,
        (45, 333.0),  // -
        (46, 250.0),  // .
        (47, 278.0),  // /
        (48, 500.0),  // 0
        (49, 500.0),  // 1
        (50, 500.0),  // 2
        (51, 500.0),  // 3
        (52, 500.0),  // 4
        (53, 500.0),  // 5
        (54, 500.0),  // 6
        (55, 500.0),  // 7
        (56, 500.0),  // 8
        (57, 500.0),  // 9
        (58, 278.0),  // :
        (59, 278.0),  // ;
        (60, 564.0),  // <
        (61, 564.0),  // =
        (62, 564.0),  // >
        (63, 444.0),  // ?
        (64, 921.0),  // @
        (65, 722.0),  // A
        (66, 667.0),  // B
        (67, 667.0),  // C
        (68, 722.0),  // D
        (69, 611.0),  // E
        (70, 556.0),  // F
        (71, 722.0),  // G
        (72, 722.0),  // H
        (73, 333.0),  // I
        (74, 389.0),  // J
        (75, 722.0),  // K
        (76, 611.0),  // L
        (77, 889.0),  // M
        (78, 722.0),  // N
        (79, 722.0),  // O
        (80, 556.0),  // P
        (81, 722.0),  // Q
        (82, 667.0),  // R
        (83, 556.0),  // S
        (84, 611.0),  // T
        (85, 722.0),  // U
        (86, 722.0),  // V
        (87, 944.0),  // W
        (88, 722.0),  // X
        (89, 722.0),  // Y
        (90, 611.0),  // Z
        (91, 333.0),  // [
        (92, 278.0),  // backslash
        (93, 333.0),  // ]
        (94, 469.0),  // ^
        (95, 500.0),  // _
        (96, 333.0),  // `
        (97, 444.0),  // a
        (98, 500.0),  // b
        (99, 444.0),  // c
        (100, 500.0), // d
        (101, 444.0), // e
        (102, 333.0), // f
        (103, 500.0), // g
        (104, 500.0), // h
        (105, 278.0), // i
        (106, 278.0), // j
        (107, 500.0), // k
        (108, 278.0), // l
        (109, 778.0), // m
        (110, 500.0), // n
        (111, 500.0), // o
        (112, 500.0), // p
        (113, 500.0), // q
        (114, 333.0), // r
        (115, 389.0), // s
        (116, 278.0), // t
        (117, 500.0), // u
        (118, 500.0), // v
        (119, 722.0), // w
        (120, 500.0), // x
        (121, 500.0), // y
        (122, 444.0), // z
        (123, 480.0), // {
        (124, 200.0), // |
        (125, 480.0), // }
        (126, 541.0), // ~
    ];

    for &(code, width) in data {
        widths.insert(code, width);
    }
}
